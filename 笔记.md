## 一、创建项目

1、第一步：打开命令行窗口。

2、第二步：执行创建项目命令行

vue create vue3_project(项目可以任意，最好是英文)

3、自定义创建

![image-20230406201436211](笔记.assets/image-20230406201436211.png)

4、第四步：选中vue-router,vuex,css Pre-processors选项

![image-20230406201501041](笔记.assets/image-20230406201501041.png)

5、选择vue3.0版本，选择hash模式的路由，

选择less作为预处理器，选择 standard 标准代码风格；（这里就不配图了）

6、选择 standard 标准代码风格，保存代码校验代码风格，代码提交时候校验代码风格，依赖插件或者工具的配置文件分文件保存

![image-20230406201635394](笔记.assets/image-20230406201635394.png)

![image-20230406201644228](笔记.assets/image-20230406201644228.png)

![image-20230406201708595](笔记.assets/image-20230406201708595.png)

7、是否记录以上操作，选择否，最后等待安装即可。

## 二、目录调整

大致步骤：

- 删除无用代码和文件
- 完善项目的基础结构
- 读懂默认生成的代码

![image-20230406201908803](笔记.assets/image-20230406201908803.png)

## 三、vuex基础

### 1、根模块的用法



```js
// sotre/index.js
import { createStore } from 'vuex'

export default createStore({
  state: {
    username: 'zs'
  },
  getters: {
    newName(state){
      return state.username + '!!'
    }
  },
  mutations: {
    updateName(state){
      state.username = 'ls'
    }
  },
  actions: {
    updateName(ctx) {
      setTimeout(() => {
        ctx.commit('updateName')
      }, 1000);
    }
  },
  modules: {
  }
})

```

App.vue

```vue
<template>
  <div>
    APP
    <p>{{ $store.state.username }}</p>

    <p>{{ $store.getters['newName'] }}</p>

    <button @click="mutationsFn">mutationsFn</button>
  </div>
</template>

<script >
import { useStore } from "vuex";
import { useRouter } from "vue-router";
export default {
  name: "App",
  setup() {
    // 使用vuex仓库
    const store = useStore();
    console.log(store.state.username);
    console.log(store.getters.newName);
    // console.log(store);
    // const router = useRouter()
    // console.log(router);
    const mutationsFn=() => {
      //store.commit('updateName')
      // 调用根模块actions函数
      store.dispatch('updateName')
    }
    return {mutationsFn}
  },
};
</script>

```

### 2、modules (分模块)

- 存在两种情况
  - 默认的模块，`state` 区分模块，其他 `getters` `mutations` `actions` 都在全局。
  - 带命名空间 `namespaced: true` 的模块，所有功能区分模块，更高封装度和复用。

```js

import { createStore } from 'vuex'

const moduleA = {
  state: {
    username: 'moduleA'
  },
  getters: {
    newName(state) {
      return state.username + '11'
    }
  },
  mutations: {
    updateName(state) {
      state.username = 'moduleAAAA'
    }
  }
}

// B模块
const moduleB = {
  namespaced: true,
  state: {
    username: 'moduleB'
  },
  getters: {
    newName(state) {
      return state.username + '11'
    }
  },
  mutations: {
    updateName(state) {
      state.username = 'moduleBBBB'
    }
  },
  actions: {
    updateName(ctx) {
      setTimeout(() => {
        ctx.commit('updateName')
      }, 1000);
    }
  }
}

export default createStore({
  modules: {
    moduleA,
    moduleB
  }
})

```

```vue
<template>
  <div>
    APP
    <!--使用A模块的state数据-->
    <p>{{ $store.state.moduleA.username }}</p>
    <!--使用A模块的getters数据-->
    <p>{{ $store.getters.newName }}</p>
    <!--使用B模块的state数据-->
    <p>{{ $store.state.moduleB.username }}</p>
     <!--使用B模块的getters数据  B模块用到了命名空间-->
    <p>{{ $store.getters['moduleB/newName'] }}</p>

    <button @click="mutationsFn">mutationsFn</button>
    <button @click="actionsFn">actionsFn</button>
  </div>
</template>

<script >
import { useStore } from "vuex";
export default {
  name: "App",
  setup() {
    const store = useStore()

    const mutationsFn =() => {
      store.commit("moduleB/updateName")
    }
    const actionsFn=()=> {
      store.dispatch('moduleB/updateName')
    }
    return {
      mutationsFn,
      actionsFn
    }
  },
};
</script>

```

## 四、vuex持久化

**目的：让在vuex中管理的状态数据同时存储在本地。可免去自己存储的环节。**

- 在开发的过程中，像用户信息（名字，头像，token）需要vuex中存储且需要本地存储。
- 再例如，购物车如果需要未登录状态下也支持，如果管理在vuex中页需要存储在本地。
- 我们需要category模块存储分类信息，但是分类信息不需要持久化。

1）首先：我们需要安装一个vuex的插件`vuex-persistedstate`来支持vuex的状态持久化。

```sh
npm i vuex-persistedstate
```

2）然后：在`src/store` 文件夹下新建 `modules` 文件，在 `modules` 下新建 `user.js` 和 `cart.js`

**src/store/modules/user.js**

