## 一、创建项目

1、第一步：打开命令行窗口。

2、第二步：执行创建项目命令行

vue create vue3_project(项目可以任意，最好是英文)

3、自定义创建

![image-20230406201436211](笔记.assets/image-20230406201436211.png)

4、第四步：选中vue-router,vuex,css Pre-processors选项

![image-20230406201501041](笔记.assets/image-20230406201501041.png)

5、选择vue3.0版本，选择hash模式的路由，

选择less作为预处理器，选择 standard 标准代码风格；（这里就不配图了）

6、选择 standard 标准代码风格，保存代码校验代码风格，代码提交时候校验代码风格，依赖插件或者工具的配置文件分文件保存

![image-20230406201635394](笔记.assets/image-20230406201635394.png)

![image-20230406201644228](笔记.assets/image-20230406201644228.png)

![image-20230406201708595](笔记.assets/image-20230406201708595.png)

7、是否记录以上操作，选择否，最后等待安装即可。

## 二、目录调整

大致步骤：

- 删除无用代码和文件
- 完善项目的基础结构
- 读懂默认生成的代码

![image-20230406201908803](笔记.assets/image-20230406201908803.png)

## 三、vuex基础

### 1、根模块的用法



```js
// sotre/index.js
import { createStore } from 'vuex'

export default createStore({
  state: {
    username: 'zs'
  },
  getters: {
    newName(state){
      return state.username + '!!'
    }
  },
  mutations: {
    updateName(state){
      state.username = 'ls'
    }
  },
  actions: {
    updateName(ctx) {
      setTimeout(() => {
        ctx.commit('updateName')
      }, 1000);
    }
  },
  modules: {
  }
})

```

App.vue

```vue
<template>
  <div>
    APP
    <p>{{ $store.state.username }}</p>

    <p>{{ $store.getters['newName'] }}</p>

    <button @click="mutationsFn">mutationsFn</button>
  </div>
</template>

<script >
import { useStore } from "vuex";
import { useRouter } from "vue-router";
export default {
  name: "App",
  setup() {
    // 使用vuex仓库
    const store = useStore();
    console.log(store.state.username);
    console.log(store.getters.newName);
    // console.log(store);
    // const router = useRouter()
    // console.log(router);
    const mutationsFn=() => {
      //store.commit('updateName')
      // 调用根模块actions函数
      store.dispatch('updateName')
    }
    return {mutationsFn}
  },
};
</script>

```

### 2、modules (分模块)

- 存在两种情况
  - 默认的模块，`state` 区分模块，其他 `getters` `mutations` `actions` 都在全局。
  - 带命名空间 `namespaced: true` 的模块，所有功能区分模块，更高封装度和复用。

```js

import { createStore } from 'vuex'

const moduleA = {
  state: {
    username: 'moduleA'
  },
  getters: {
    newName(state) {
      return state.username + '11'
    }
  },
  mutations: {
    updateName(state) {
      state.username = 'moduleAAAA'
    }
  }
}

// B模块
const moduleB = {
  namespaced: true,
  state: {
    username: 'moduleB'
  },
  getters: {
    newName(state) {
      return state.username + '11'
    }
  },
  mutations: {
    updateName(state) {
      state.username = 'moduleBBBB'
    }
  },
  actions: {
    updateName(ctx) {
      setTimeout(() => {
        ctx.commit('updateName')
      }, 1000);
    }
  }
}

export default createStore({
  modules: {
    moduleA,
    moduleB
  }
})

```

```vue
<template>
  <div>
    APP
    <!--使用A模块的state数据-->
    <p>{{ $store.state.moduleA.username }}</p>
    <!--使用A模块的getters数据-->
    <p>{{ $store.getters.newName }}</p>
    <!--使用B模块的state数据-->
    <p>{{ $store.state.moduleB.username }}</p>
     <!--使用B模块的getters数据  B模块用到了命名空间-->
    <p>{{ $store.getters['moduleB/newName'] }}</p>

    <button @click="mutationsFn">mutationsFn</button>
    <button @click="actionsFn">actionsFn</button>
  </div>
</template>

<script >
import { useStore } from "vuex";
export default {
  name: "App",
  setup() {
    const store = useStore()

    const mutationsFn =() => {
      store.commit("moduleB/updateName")
    }
    const actionsFn=()=> {
      store.dispatch('moduleB/updateName')
    }
    return {
      mutationsFn,
      actionsFn
    }
  },
};
</script>

```

## 四、本地项目托管到Gitee

1、先在Gitee上创建一个仓库（点击右上角的+ 号就能创建）

![image-20230406212347663](笔记.assets/image-20230406212347663.png)

**注意把第一个对勾去掉**

![image-20230406212503267](笔记.assets/image-20230406212503267.png)

如果是第一次将代码推送到码云，在新建仓库之前先去申请SSH公钥，具体教程网上都有，申请之后执行Git全局配置，（之前有推送代码到码云，第二次就不需要初始化配置了）

2、在项目路径下cmd进入命令窗口，执行如下命令

```sh
git add .

git commit - m "add files"

git status(这里如果显示 working tree clean 就代表工作区已经干净)


```

![image-20230406213508569](笔记.assets/image-20230406213508569.png)

执行红色框框里面的代码即可（在项目路径下）



## 五、vuex持久化

**目的：让在vuex中管理的状态数据同时存储在本地。可免去自己存储的环节。**

- 在开发的过程中，像用户信息（名字，头像，token）需要vuex中存储且需要本地存储。
- 再例如，购物车如果需要未登录状态下也支持，如果管理在vuex中页需要存储在本地。
- 我们需要category模块存储分类信息，但是分类信息不需要持久化。

1）首先：我们需要安装一个vuex的插件`vuex-persistedstate`来支持vuex的状态持久化。

```sh
npm i vuex-persistedstate
```

这个时候可能会报错

![image-20230407102331983](笔记.assets/image-20230407102331983.png)

大致看了报错信息，应该是eslint-config-standard和eslint-plugin-vue版本不对应导致的，我们可以选择下面2种解决方案

```sh
npm i vuex-persistedstate --legacy-peer-deps

```

```sh
npm i vuex-persistedstate --force
```

2）然后：在`src/store` 文件夹下新建 `modules` 文件，在 `modules` 下新建 `user.js` 和 `cart.js`

**src/store/modules/user.js**

```js
// 用户模块
export default {
  namespaced: true,
  state () {
    return {
      // 用户信息
      profile: {
        id: '',
        avatar: '',
        nickname: '',
        account: '',
        mobile: '',
        token: ''
      }
    }
  },
  mutations: {
    // 修改用户信息，payload就是用户信息对象
    setUser (state, payload) {
      state.profile = payload
    }
  }
}

```

src/store/modules/cart.js:

```js
// 购物车状态
export default {
  namespaced: true,
  state: () => {
    return {
      list: []
    }
  }
}

```

src/store/modules/category.js

```js
// 分类模块
export default {
  namespaced: true,
  state () {
    return {
      // 分类信息集合
      list: []
    }
  }
}

```

3）继续：在 `src/store/index.js` 中导入 user cart 模块，并使用vuex-persistedstate插件来进行持久化

```js

import { createStore } from 'vuex'
import createPersistedState from 'vuex-persistedstate'
import user from './modules/user'
import cart from './modules/cart'
import category from './modules/category'

export default createStore({
  modules: {
    user,
    cart,
    category
  },
   // 配置插件
   plugins: [
    // 默认存储在localStorage
    createPersistedState({
      // 本地存储名字
      key: 'erabbit-client-pc-124-store',
      // 指定需要存储的模块
      paths: ['user', 'cart']
    })
  ]
})

```

**测试：** user模块定义一个mutation在main.js去调用下，观察浏览器application的localStorage下数据。

```vue
<template>
  <div>
    APP
       <!-- 修改数据，测试是否持久化 -->
     {{ $store.state.user.profile.account }}
    <button @click="$store.commit('user/setUser',{account: 'zhangsang'})">设置用户信息</button>
  </div>
</template>

<script >

export default {
  name: 'App',
  setup () {
    
  }
}
</script>
```

![image-20230407104255582](笔记.assets/image-20230407104255582.png)

无论刷新多少次数据都是持久化

## 六、请求工具

- 安装 axios

```sh
npm i axios
```

或者

```sh
npm i axios --force
```

- 新建 `src/utils/request.js` 模块，代码如下
